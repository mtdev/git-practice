This is a work in progress; it has not yet been merged with master.
